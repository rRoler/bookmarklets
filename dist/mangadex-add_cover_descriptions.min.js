javascript:(() => {function e(e,t,n=0){const o=e.match(t);if(o&&o[n])return o[n]}function t(e,t=!1){let n=document.body.querySelector(e);return new Promise((o=>{if(t?!n:n)return o(n);const l=new MutationObserver((()=>{n=document.body.querySelector(e),(t?!n:n)&&(o(n),l.disconnect())}));l.observe(document.body,{childList:!0,subtree:!0})}))}const n=e(window.location.pathname,/\/title\/+([-0-9a-f]{20,})/,1)||e(window.location.pathname,/\/title\/edit\/+([-0-9a-f]{20,})/,1);((e,t={})=>{(function(e,t){if(!new RegExp(e).test(window.location.hostname))return alert("Bookmarklet executed on the wrong website!");t()})("^mangadex.org|canary.mangadex.dev",(()=>{const o=t.createPage&&/\/create\//.test(window.location.pathname),l="You can execute this bookmarklet only on ";return!t.titlePage||n||o?!t.editPage||/\/edit\//.test(window.location.pathname)||o?void e():alert(l+"an edit page!"):alert(l+"a title page!")}))})((async()=>{const e=prompt("Enter a description:","Volume $volume Cover from BookWalker");if(!e)return;const n=[],o=Array.from(document.querySelectorAll("div.page-sizer"));for(const t of o)if(/blob:https?:\/\/.*mangadex.*\/+[-0-9a-f]{20,}/.test(t.querySelector(".page").style.getPropertyValue("background-image"))){var l;const o=r(t,e),i=null===(l=t.parentElement)||void 0===l?void 0:l.querySelector(".volume-edit");null==i||i.dispatchEvent(new MouseEvent("click"));await a(o)&&n.push(t)}if(n.length<=0)return alert("No newly added covers with empty descriptions found!");function r(e,t){var n,o;const l=null===(n=e.parentElement)||void 0===n?void 0:n.querySelector(".volume-num input"),r=null==l?void 0:l.value,a=null===(o=e.parentElement)||void 0===o?void 0:o.querySelector(".md-select .md-select-inner-wrap .placeholder-text"),i={volume:r||"No Volume",language:(null==a?void 0:a.innerText)||"No Language",nl:"\n"};for(const e in i){const n=i[e];n&&(t=t.replaceAll(`$${e}`,n))}return t}function a(e){return new Promise((n=>{const o='textarea[placeholder="Cover Information"]';t(o).then((l=>{var r;let a=!0;const i=null==l||null===(r=l.parentElement)||void 0===r||null===(r=r.parentElement)||void 0===r||null===(r=r.parentElement)||void 0===r||null===(r=r.parentElement)||void 0===r?void 0:r.querySelector("button.primary");l.value?a=!1:l.value=e,null==l||l.dispatchEvent(new InputEvent("input")),null==i||i.dispatchEvent(new MouseEvent("click")),t(o,!0).then((()=>n(a)))}))}))}console.log("Added descriptions:",n)}),{titlePage:!0,editPage:!0,createPage:!0});})();
