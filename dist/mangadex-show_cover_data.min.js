javascript:(() => {function e(e,t,n=0){const o=e.match(t);if(o&&o[n])return o[n]}function t(e,t=100){const n=[...e],o=[];for(;n.length;)o.push(n.splice(0,t));return o}function n(e,t){for(const n in t)e.style.setProperty(n,t[n])}const o=e(window.location.pathname,/\/title\/+([-0-9a-f]{20,})/,1)||e(window.location.pathname,/\/title\/edit\/+([-0-9a-f]{20,})/,1);function r(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class i{constructor(e=0){r(this,"add",(()=>document.body.appendChild(this.element))),r(this,"remove",(()=>this.element.remove()));const t=document.createElement("div");n(t,{"z-index":"1000",position:"fixed",bottom:"0",left:"0",width:"100%",height:"24px","background-color":"#3c3c3c",cursor:"pointer"});const o=document.createElement("div");n(o,{height:"100%","background-color":"#b5e853",transition:"width 200ms"}),this.bar=o,this.update(e),t.appendChild(o),t.addEventListener("click",this.remove),this.element=t}update(e){const t=Math.ceil(parseInt(this.bar.style.getPropertyValue("width"))),o=Math.ceil(e);o>=100?this.remove():t!==o&&o>=0&&n(this.bar,{width:`${o}%`})}}((e,t={})=>{(function(e,t){if(!new RegExp(e).test(window.location.hostname))return alert("Bookmarklet executed on the wrong website!");t()})("^mangadex.org|canary.mangadex.dev",(()=>{const n=t.createPage&&/\/create\//.test(window.location.pathname),r="You can execute this bookmarklet only on ";return!t.titlePage||o||n?!t.editPage||/\/edit\//.test(window.location.pathname)||n?void e():alert(r+"an edit page!"):alert(r+"a title page!")}))})((()=>{const o=100,r=1e3,a=[],c=new Map,s=new Map,d={manga:[],cover:[]},l=new i;if(document.querySelectorAll("img, div").forEach((t=>{const n=t.src||t.style.getPropertyValue("background-image");if(!/\/covers\/+[-0-9a-f]{20,}\/+[-0-9a-f]{20,}[^/]+(?:[?#].*)?$/.test(n)||t.classList.contains("banner-image"))return;const o=e(n,/[-0-9a-f]{20,}/),r=e(n,/([-0-9a-f]{20,}\.[^/.]*)\.[0-9]+\.[^/.?#]*([?#].*)?$/,1)||e(n,/[-0-9a-f]{20,}\.[^/.]*?$/);if(!o||!r)return;const i=e=>{var t;e.has(o)?null===(t=e.get(o))||void 0===t||t.add(r):e.set(o,new Set([r]))};"executed"!==t.getAttribute("cover-data-bookmarklet")?(a.push(t),t.setAttribute("cover-data-bookmarklet","executed"),i(c)):i(s)})),c.size<=0)return document.querySelector('[cover-data-bookmarklet="executed"]')?alert("No new covers were found on this page since the last time this bookmarklet was executed!"):alert("No covers were found on this page!");function u(e,t,o,r){e.setAttribute("cover-data-cover-id",r.id);const i=document.createElement("span"),a=document.createElement("span"),c=function({fill:e="none",viewBox:t="0 0 24 24",stroke:n="currentColor",strokeLinecap:o="round",strokeLinejoin:r="round",d:i=""}){const a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.setAttribute("fill",e),a.setAttribute("viewBox",t),a.setAttribute("stroke",n);const c=document.createElementNS("http://www.w3.org/2000/svg","path");return c.setAttribute("stroke-linecap",o),c.setAttribute("stroke-linejoin",r),c.setAttribute("d",i),a.appendChild(c),a}({d:"M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"});if(a.classList.add("cover-data-bookmarklet-description"),r.attributes.description){const e=(e,t=!0)=>{const o=e=>n(e,{display:t?"flex":"none"});e.stopPropagation(),e.preventDefault(),e.shiftKey?document.querySelectorAll(".cover-data-bookmarklet-description").forEach((e=>o(e))):o(a)};i.setAttribute("title",r.attributes.description),c.addEventListener("click",e),i.appendChild(c);const t=document.createElement("span");t.innerText=r.attributes.description,n(t,{"max-height":"100%",margin:"0.2rem","text-align":"center"}),n(a,{position:"absolute",width:"100%",height:"100%","overflow-y":"auto",display:"none","align-items":"center","justify-content":"center","background-color":"var(--md-accent)","z-index":"4"}),a.addEventListener("click",(t=>e(t,!1))),a.appendChild(t)}const s=document.createElement("span"),d=document.createElement("span"),l=`${t}x${o}`;d.innerText=l,d.setAttribute("title",l+"\n(click to copy id)"),d.addEventListener("click",(e=>{const t=e=>{navigator.clipboard.writeText(e).then((()=>console.debug(`Copied cover ids: ${e}`)),(()=>console.error(`Failed to copy cover ids: ${e}`))).catch(console.error)};if(e.stopPropagation(),e.preventDefault(),e.shiftKey){const e=[];document.querySelectorAll("[cover-data-cover-id]").forEach((t=>{const n=t.getAttribute("cover-data-cover-id");n&&!e.includes(n)&&e.push(n)})),t(e.join(" "))}else t(r.id)})),n(s,{position:"absolute",top:"0"}),s.appendChild(d);const u=document.createElement("div");if(n(u,{display:"flex","flex-wrap":"nowrap",gap:"0.2rem"}),e instanceof HTMLImageElement){var p,h;if(n(s,{padding:"0.5rem 0.5rem 1rem",color:"#fff",left:"0",width:"100%",background:"linear-gradient(0deg,transparent,rgba(0,0,0,0.8))","border-top-right-radius":"0.25rem","border-top-left-radius":"0.25rem"}),n(u,{position:"absolute",top:"0",right:"0",padding:"0.45rem 0.5rem",color:"#fff"}),r.attributes.description)c.setAttribute("stroke-width","1.5"),n(c,{width:"1.5rem",height:"1.5rem"}),n(a,{"border-radius":"0.25rem"}),null===(h=e.parentElement)||void 0===h||h.append(a),u.appendChild(i);null===(p=e.parentElement)||void 0===p||p.append(s,u)}else n(s,{padding:"0 0.2rem","background-color":"var(--md-accent)","border-bottom-left-radius":"4px","border-bottom-right-radius":"4px"}),e.appendChild(s),n(u,{"margin-left":"0.2rem"}),n(s,{display:"flex","flex-wrap":"nowrap","align-items":"center"}),r.attributes.description&&(c.setAttribute("stroke-width","2"),n(c,{width:"1.3rem",height:"1.3rem"}),e.appendChild(a),u.appendChild(i)),s.appendChild(u),e.appendChild(s)}function p(e,t,n=0){return new Promise(((i,a)=>{const c="cover"===t,s=e.map((e=>c?`manga[]=${e}`:`ids[]=${e}`)).join("&");let d=`https://api.mangadex.org/${t}?${s}&includes[]=cover_art&limit=${o}&contentRating[]=safe&contentRating[]=suggestive&contentRating[]=erotica&contentRating[]=pornographic&offset=${n}`;if(c&&(d=`https://api.mangadex.org/${t}?order[volume]=asc&${s}&limit=${o}&offset=${n}`),n>r)return a(new Error(`Offset is bigger than ${r}:\n ${d}`));fetch(d).then((e=>i(e.json()))).catch(a)}))}l.add(),c.forEach(((e,t)=>{var n;const o=(null===(n=s.get(t))||void 0===n?void 0:n.size)||0;e.size+o>1?d.cover.push(t):d.manga.push(t)})),function(){const e=[];return new Promise(((n,o)=>{(async function(){for(const n in d){const o="cover"===n,r=t(d[n]);for(const t of r){const r=await p(t,n);if(o){e.push(...r.data);for(let o=r.limit;o<r.total;o+=r.limit){const r=await p(t,n,o);e.push(...r.data)}}else r.data.forEach((t=>{const n=t.relationships.find((e=>"cover_art"===e.type));n&&(n.relationships=[{type:t.type,id:t.id}],e.push(n))}))}}return e})().then(n).catch(o)}))}().then((e=>{let t=0,o=0;const r=document.createElement("div");n(r,{width:"fit-content",height:"fit-content",opacity:"0",position:"absolute",top:"-10000px","z-index":"-10000","pointer-events":"none"}),document.body.appendChild(r),a.forEach((n=>{const i=n.src||n.style.getPropertyValue("background-image");let c;const s=e.find((e=>{if(c=e.relationships.find((e=>"manga"===e.type)),c&&new RegExp(`${c.id}/${e.attributes.fileName}`).test(i))return e}));if(!s||!c)return++o,void d();function d(){if(t+o>=a.length){if(o>0)throw new Error(`${o} primary covers were changed after the page loaded and before the bookmarklet was executed.\nReload the page and execute the bookmarklet again!`);l.remove()}}const p=new Image;r.appendChild(p);try{new ResizeObserver(((e,o)=>{const i=p.naturalWidth,c=p.naturalHeight;i>0&&c>0&&(o.disconnect(),p.remove(),p.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQIW2NgAAIAAAUAAR4f7BQAAAAASUVORK5CYII=",r.children.length<=0&&r.remove(),u(n,i,c,s),l.update(++t/a.length*100),d())})).observe(p)}catch(e){p.onload=()=>{p.remove(),r.children.length<=0&&r.remove(),u(n,p.naturalWidth,p.naturalHeight,s),l.update(++t/a.length*100),d()}}p.src=`https://mangadex.org/covers/${c.id}/${s.attributes.fileName}`}))})).catch((e=>{console.error(e),alert("Failed to fetch cover data!\n"+e.message)}))}));})();
